services:
  text-exporter:
    build:
      context: .
      dockerfile: ./image/text-exporter/Dockerfile
    hostname: ${HOSTNAME:-CHANGEME}
    volumes:
      - promfile:/app/data
    env_file:
      - .env
    ports:
      - ${BIND-9014}:9014
    entrypoint:
    - /usr/bin/textfile_exporter
    - -p
    - ./data
    restart: on-failure:10
  lsusb:
    build:
      context: .
      dockerfile: ./image/lsusb/Dockerfile
    volumes:
      - /dev:/dev:ro
      - promfile:/app/data
      - ./run.sh:/app/run.sh:ro
    entrypoint: "./run.sh"
    restart: on-failure:10

volumes:
  promfile:
